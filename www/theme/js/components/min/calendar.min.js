function Calendar(a){var b=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],c=$(a);if(0===c.length)return null;var d="";this.setData=function(a,e,f){d='<div class="calendar">',d+='<p class="month-name">'+b[a.getMonth()]+"</p>",d+="<table><thead><tr><th>Пн</th><th>Вт</th><th>Ср</th><th>Чт</th><th>Пт</th><th>Сб</th><th>Вс</th></tr></thead><tbody>";for(var g=new Date(a.getFullYear(),a.getMonth(),a.getDate()-(0==a.getDay()?7:a.getDay())+1),h=new Date(e.getFullYear(),e.getMonth(),e.getDate()+(7-(0==e.getDay()?7:e.getDay()))),i=new Date,j=new Date(g);;){1==j.getDay()&&(d+="<tr>");var k=[];1==j.getDay()&&k.push("first"),(0==j.getDay()||6==j.getDay())&&k.push("weekend"),(a>j||j>e)&&k.push("disabled"),j.getDate()==i.getDate()&&j.getMonth()==i.getMonth()&&j.getFullYear()==i.getFullYear()&&k.push("today");var l=(j.getDate()<10?"0"+j.getDate():j.getDate())+"."+(j.getMonth()<10?"0"+j.getMonth():j.getMonth())+"."+j.getFullYear(),m=l in f?f[l].toString():"бесплатно";if(d+='<td class="'+k.join(" ")+'"><span class="day">'+(j.getDate()<10?"0"+j.getDate():j.getDate())+'</span><span class="price">'+m+"</span></td>",0==j.getDay()&&(d+="</tr>"),j=new Date(j.getFullYear(),j.getMonth(),j.getDate()+1),j.getFullYear()>h.getFullYear())break;if(j.getFullYear()==h.getFullYear()&&j.getMonth()>h.getMonth())break;if(j.getFullYear()==h.getFullYear()&&j.getMonth()==h.getMonth()&&j.getDate()>h.getDate())break}d+="</tbody></table>",h.getMonth()!=g.getMonth()&&(d+='<p class="month-name month-name-bottom">'+b[h.getMonth()]+"</p>"),d+="</div>",c.html(d)}}$.fn.Calendar=function(a){function b(a,b){return Math.abs((b-a)/864e5)}function c(a){var b=a.getFullYear(),c=a.getMonth(),d=a.getDate();return b+(10>c?"0":"")+c+(10>d?"0":"")+d}var d=this,e=$(this),f=new Date;f=new Date(f.getFullYear(),f.getMonth(),f.getDate(),0,0,0),a=$.extend({onChange:function(){}},a),this.checkDate=function(a){var c=!0;if(a.getFullYear()<f.getFullYear()||a.getMonth()<f.getMonth()||a.getDate()<f.getDate())c=!1;else{var d=b(a,f);d>14&&(c=!1)}return c},this.renderHTML=function(b,g){var h,i,j=0,k=function(a,b){var e=g,h=b;0>h&&(h=11,e--),h>11&&(h=0,e++);var i=new Date(e,h,a),k="";if(0==j&&(k='<tr class="days">'),d.checkDate(i)){var l=[];(6==i.getDay()||0==i.getDay())&&l.push("weekend"),i.getDate()==f.getDate()&&i.getMonth()==f.getMonth()&&i.getFullYear()==f.getFullYear()&&l.push("today"),k+='<td data-date="'+c(i)+'" class="calendar-day '+l.join(" ")+'"><span>'+a+"</span></td>"}else k+='<td data-date="'+c(i)+'" class="calendar-day prev-month">'+a+"</td>";return j++,0==j%7&&(j=0,k+="</tr>"),k},l='<table width="100%" cellpadding="0" cellspacing="0" class="calendar-table"><tr class="weekdays"><td class="calendar-day first">Пн</td><td class="calendar-day">Вт</td><td class="calendar-day">Ср</td><td class="calendar-day">Чт</td><td class="calendar-day">Пт</td><td class="calendar-day weekend">Сб</td><td class="calendar-day weekend last">Вс</td></tr>';l+='<tr class="days first-line">';var m=new Date(g,b,1).getDay();m=0==m?7:m;var n=m-1,o=new Date(g,b,0).getDate();for(h=n;h>0;h--)l+=k(o-h+1,b-1);for(i=1,h=m;7>=h;h++,i++)l+=k(i,b);var p=new Date(g,b+1,0),q=0==p.getDay()?7:p.getDay(),r=p.getDate()-q,s=7-m+2;for(i=1,h=s;r>=h;h++,i++)l+=k(h,b);for(h=r+1;h<=new Date(g,b+1,0).getDate();h++)l+=k(h,b);for(h=1;7-q>=h;h++)l+=k(h,b+1);l+="</table>",e.html(l),e.find(".days .calendar-day").not(".prev-month").click(function(){var b=$(this).data("date").toString();b=new Date(b.substr(0,4),b.substr(4,2),b.substr(6,2)),a.onChange(b)})},this.renderHTML(f.getMonth(),f.getFullYear()),$(document).click(function(a){0===$(a.target).parents(".calendar-table").length&&e.parent().hide()})};